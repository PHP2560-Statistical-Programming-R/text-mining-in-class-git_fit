data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = TRUE)
books[[i]] <- data
}
book_names
book_names <- list(philosophers_stone, chamber_of_secrets, prisoner_of_azkaban, goblet_of_fire, order_of_the_phoenix, half_blood_prince, deathly_hallows)
book_names <- list(philosophers_stone, chamber_of_secrets, prisoner_of_azkaban, goblet_of_fire, order_of_the_phoenix, half_blood_prince, deathly_hallows)
names(book_names) <- c("philosophers_stone", "chamber_of_secrets", "prisoner_of_azkaban", "goblet_of_fire", "order_of_the_phoenix", "half_blood_prince", "deathly_hallows")
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = TRUE)
books[[i]] <- data
}
#Carol-Goblet of Fire:
#(1) How the sentiment changes across the entire book
bing <- get_sentiments("bing")
cs_book= books[[4]]
sentiment_4=inner_join(cs_book, bing)
philosophers_stone
library("harrypotter", lib.loc="~/Library/R/3.4/library")
book_names <- list(philosophers_stone, chamber_of_secrets, prisoner_of_azkaban, goblet_of_fire, order_of_the_phoenix, half_blood_prince, deathly_hallows)
names(book_names) <- c("philosophers_stone", "chamber_of_secrets", "prisoner_of_azkaban", "goblet_of_fire", "order_of_the_phoenix", "half_blood_prince", "deathly_hallows")
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = TRUE)
books[[i]] <- data
}
#Carol-Goblet of Fire:
#(1) How the sentiment changes across the entire book
bing <- get_sentiments("bing")
cs_book= books[[4]]
sentiment_4=inner_join(cs_book, bing)
philosophers_stone
book_names <- list(philosophers_stone, chamber_of_secrets, prisoner_of_azkaban, goblet_of_fire, order_of_the_phoenix, half_blood_prince, deathly_hallows)
names(book_names) <- c("philosophers_stone", "chamber_of_secrets", "prisoner_of_azkaban", "goblet_of_fire", "order_of_the_phoenix", "half_blood_prince", "deathly_hallows")
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = TRUE)
books[[i]] <- data
}
#Carol-Goblet of Fire:
#(1) How the sentiment changes across the entire book
bing <- get_sentiments("bing")
cs_book= books[[4]]
sentiment_4=inner_join(cs_book, bing)
sentiment_4 %>% count(sentiment)
sentiment_4
sentiment_4 %>% dplyr::count(sentiment)
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment)
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% sum(n)
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr::sum(n)
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr::count(n)
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr::sum(n)
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr:: mutate(total_words=sum(n))
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr:: arrange(desc(sentiments))
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr::arrange(desc(sentiments))
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr::arrange(desc(n))
sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
stopwords("en")
install.packages("https://www.rdocumentation.org/packages/tm", lib="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
library("tm", lib.loc="~/Library/R/3.4/library")
stopwords("en")
stop=stopwords("en")
comm_words<-sentiment_4 %>% dplyr::filter(-stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
sentiment_4 %>% dplyr::filter(word!=stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
sentiment_4 %>% dplyr::filter(-word==stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
sentiment_4 %>% dplyr::filter(word!=stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
stop=stopwords("en")
sentiment_4 %>% dplyr::filter(word!=stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
cap <- char_class("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
Char_4<-str_subset(books[[4]], pattern = START %R% cap)
library(rebus)
cap <- char_class("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
Char_4<-str_subset(books[[4]], pattern = START %R% cap)
Char_4
cap <- char_class("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
Char_4<-str_extract(books[[4]]$word, pattern=START %R% cap)
Char_4
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap <- char_class("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
Char_4<-str_extract(books[[4]]$word, pattern=START %R% cap)
char_list<-sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap <- char_class("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-sentiment_4 %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list
stop
upper(stop)
up_uppercase(stop)
up_cased(stop)
stop
stri_trans_totitle(stop)
library("stringi", lib.loc="~/Library/R/3.4/library")
stri_trans_totitle(
stop)
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-sentiment_4 %>% filter(!cap_stop) dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list<-sentiment_4 %>% filter(!=cap_stop) dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list<-sentiment_4 %>% filter(!=cap_stop) dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
sentiment_4
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-sentiment_4 %>% filter(word!=cap_stop) dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
sentiment_4
cap_stop=stri_trans_totitle(stop)
cap_stop
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-sentiment_4 %>% filter(!(word %in% cap_stop)) dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-sentiment_4 %>% filter(!word %in% cap_stop) dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-sentiment_4 %>% filter(!word %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern= UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-sentiment_4 %>% filter(!word %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list
Char_4
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-Char_4 %>% filter(!word %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
char_list<-Char_4 %>% filter(!is.na(word)) %>% filter(!word %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% ANY_CHAR %R% ANY_CHAR)
Char_4
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER)
char_list<-Char_4 %>% filter(!is.na(word)) %>% filter(!word %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
Char_4
books[[4]]$word
Char_4<-str_extract(books[[4]]$word, pattern=START %R% UPPER %R% END)
Char_4
cap_stop=stri_trans_totitle(stop)
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
Char_4
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
char_list<-Char_4 %>% filter(!is.na(word)) %>% filter(!word %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list<-Char_4 %>% filter(!word %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
Char_4 %>% filter(!word %in% cap_stop)
Char_4
data_frame(Char_4) %>% filter(!word %in% cap_stop)
data_frame(Char_4)
names(data_frame(Char_4))
char_list<-data_frame(Char_4) %>% filter(Char_4 %in% cap_stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
Char_4
class(Char_4)
books[[4]]$word
books[[4]]
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
char_list<-data_frame(Char_4) %>% filter(Char_4 %in% cap_stop)
char_list
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
char_list<-data_frame(Char_4) %>% filter(!Char_4 %in% cap_stop)
char_list
char_list<-data_frame(Char_4) %>% filter(!Char_4 %in% cap_stop) %>% unique()
char_list
right_join(books[[4]], char_list)
right_join(books[[4]], char_list, by=word)
char_list
data_frame(word=Char_4)
char_list<-data_frame(word=Char_4) %>% filter(!word %in% cap_stop) %>% unique()
char_list
right_join(books[[4]], char_list, by=word)
books[[4]]
names(books[[4]])
names(char_list)
right_join(books[[4]], char_list, by=word)
right_join(books[[4]], char_list)
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list_2
comm_words
stop=stopwords("en")
comm_words<-sentiment_4 %>% suppressWarnings(dplyr::filter(word!=stop)) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
sentiment_4
comm_words<-sentiment_4 %>% suppressWarnings(dplyr::filter(!word %in% stop)) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
sentiment_4 %>% dplyr::filter(!word %in% stop)
sentiment_4
comm_words<-cs_book %>% dplyr::filter(!word %in% stop)
comm_words
comm_words<-cs_book %>% dplyr::filter(!word %in% stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
comm_words
stop=c(stopwords("en"), 'said')
stop
comm_words<-cs_book %>% dplyr::filter(!word %in% stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
comm_words
stop=c(stopwords("en"), 'said', 'mr', 'mrs')
comm_words<-cs_book %>% dplyr::filter(!word %in% stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
comm_words
afinn <- inner_join(data, get_sentiments("nrc"))
cs_book= books[[4]]
anti_4=inner_join(cs_book, afinn)
anti_4
nrc <- inner_join(data, get_sentiments("nrc"))
cs_book= books[[4]]
anti_4=inner_join(cs_book, nrc)
anti_4
nrc
cs_book
nrc <- inner_join(data, get_sentiments("nrc"))
cs_book= books[[4]]
anti_4=inner_join(cs_book, nrc, by=word)
nrc <- inner_join(data, get_sentiments("nrc"))
cs_book= books[[4]]
anti_4=inner_join(cs_book, nrc)
nrc
anti_4
bing <- get_sentiments("bing")
cs_book= books[[4]]
sentiment_4=inner_join(cs_book, bing)
sentiment_4
nrc <- get_sentiments("nrc")
cs_book= books[[4]]
anti_4=inner_join(cs_book, nrc)
anti_4
nrc <- get_sentiments("nrc") %>% filter(sentiment=='anticipation')
nrc
cs_book= books[[4]]
anti_4=inner_join(cs_book, nrc)
anti_4
percents_4 <- anti_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr:: mutate(total_words=sum(n))
percents_4
anti_4
percents_4
anti_4 %>% dplyr::group_by(chapter)
percents_4 <- anti_4 %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr:: mutate(total_words=sum(n))
percents_4
percents_4 <- anti_4 %>% dplyr::group_by(chapter) %>% dplyr::count(sentiment) %>% dplyr:: mutate(total_words=sum(n))
percents_4
word_count<-cs_book %>% dplyr::group_by(chapter) %>% dplyr::count(word)
word_count
word_count<-cs_book %>% dplyr::group_by(chapter) %>% dplyr::summarise(n(word))
word_count<-cs_book %>% dplyr::group_by(chapter) %>% dplyr::summarise(sum(word))
word_count<-cs_book %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::summarise(sum(n))
word_count
word_count<-cs_book %>% dplyr::summarise(sum(word))
cs_book
word_count<-cs_book %>% dplyr::summarise(count(word))
cs_book %>% dplyr::count(word)
cs_book %>% dplyr::summarise(sum(count(word)))
cs_book %>% dplyr::sum(count(word))
cs_book %>% dplyr::mutate(sum(count(word)))
cs_book
cs_book %>% dplyr::mutate(count(word))
summarise(cs_book)
summarise(cs_book,sum(word))
summarise(cs_book,count(word))
summarise(cs_book,count(word))
cs_book %>% dplyr::mutate(n=count(word))
cs_book %>% dplyr::summarise(count(word))
cs_book
cs_book %>% dplyr::summarise(n())
word_count<-cs_book %>% dplyr::summarise(total_words=n())
word_count
char_list_2
stop=c(stopwords("en"), 'said', 'mr', 'mrs')
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
char_list<-data_frame(word=Char_4) %>% filter(!word %in% cap_stop) %>% unique()
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list_2
char_list_2[1:40]
char_list_2[1:40,]
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(chapter, desc(n))
char_list_2
Char_4
stop
stop=c(stopwords("en"), 'said', 'mr', 'mrs', 'he', 'she', 'it', 'they')
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
char_list<-data_frame(word=Char_4) %>% filter(!word %in% cap_stop) %>% unique()
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(chapter, desc(n))
char_list_2
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_subset(books[[4]]$word, pattern=one_or_more(START %R% UPPER))
char_list<-data_frame(word=Char_4) %>% filter(!word %in% cap_stop) %>% unique()
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(chapter, desc(n))
char_list_2
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
Char_4
stop=c(stopwords("en"), 'said', 'mr', 'mrs', 'he', 'she', 'it', 'they', 'i', 'you')
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER)
char_list<-data_frame(word=Char_4) %>% filter(!word %in% cap_stop) %>% unique()
char_list
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER )
char_list<-data_frame(word=Char_4) %>% filter(!word %in% cap_stop) %>% unique()
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(chapter, desc(n))
char_list_2
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::count(word) %>% dplyr::arrange(chapter, desc(n))
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list_2
Char_4<-str_subset(books[[4]]$word, pattern=START %R% UPPER %R% optional(one_or_more(ANY_CHAR) %R% SPC %R% UPPER))
Char_4
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% SPC %R% UPPER
pattern2=START %R% UPPER
Char_4<-str_subset(books[[4]]$word, pattern=or(pattern1, pattern2))
Char_4
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% SPC %R% UPPER
pattern2=START %R% UPPER
Char_4<-str_subset(books[[4]]$word, pattern=or(pattern1))
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% SPC %R% UPPER
pattern2=START %R% UPPER
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% SPC %R% UPPER
pattern2=START %R% UPPER
Char_4<-str_subset(books[[4]]$word, pattern=pattern2)
Char_4
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
CHar_4
Char_4
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% END %R% SPC %R% UPPER
pattern2=START %R% UPPER
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
cap_stop=stri_trans_totitle(stop)
pattern1=START %R% UPPER %R% optional(one_or_more(ANY_CHAR) %R% END %R% SPC %R% UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
cap_stop=stri_trans_totitle(stop)
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% END %R% SPC %R% optional(UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% SPC %R% optional(UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
cap_stop=stri_trans_totitle(stop)
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% optional(UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% SPC %R% optional(UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
cap_stop=stri_trans_totitle(stop)
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) optional(%R% SPC %R% UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) optional(SPC %R% UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
pattern1=START %R% UPPER %R% one_or_more(ANY_CHAR) %R% optional(SPC %R% UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
pattern1=START %R% UPPER %R% optional(one_or_more(ANY_CHAR) %R% SPC %R% UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
pattern1=START %R% UPPER %R% optional(zero_or_more(ANY_CHAR) %R% SPC %R% UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
pattern1=START %R% UPPER %R% zero_or_more(ANY_CHAR) %R% SPC %R% optional(UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
Char_4
stop=c(stopwords("en"), 'said', 'mr', 'mrs', 'he', 'she', 'it', 'they', 'i', 'you', 'professor')
comm_words<-cs_book %>% dplyr::filter(!word %in% stop) %>% dplyr::group_by(chapter) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
#(3) Which characters appear the most
books = vector(mode = "list", length = 7)
for(i in 1:length(books)){
data <- data_frame(text = book_names[[i]])
data <- mutate(data, chapter = c(1:nrow(data)), title = names(book_names)[i])
data <- data %>%
unnest_tokens(word, text, to_lower = F)
books[[i]] <- data
}
cap_stop=stri_trans_totitle(stop)
pattern1=START %R% UPPER %R% optional(zero_or_more(ANY_CHAR) %R% SPC %R% UPPER)
Char_4<-str_subset(books[[4]]$word, pattern=pattern1)
char_list<-data_frame(word=Char_4) %>% filter(!word %in% cap_stop) %>% unique()
char_list_2<-right_join(books[[4]], char_list) %>% dplyr::count(word) %>% dplyr::arrange(desc(n))
char_list_2
